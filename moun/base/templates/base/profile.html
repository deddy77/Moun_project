{% extends 'main.html' %}
  {% block content %}
    <main class="profile-page layout layout--3">
      <div class="container">
        <!-- Topics Start -->
        {% include 'base/topics_component.html' %}
        <!-- Topics End -->

        <!-- Room List Start -->
        <div class="roomList">
          <div class="profile">
            <div class="profile__avatar">
              <div class="avatar avatar--large active">
                <img src="{{ user.avatar.url }}" />
              </div>
            </div>
            <div class="profile__info">
              <h3>{{user.name}}</h3>
              <p>@{{user.username}}<span style="color: #b2bdbd;; font-size: 14px;"><span id="follow-count"> 459</span> Followers</span></p>
              
              {% if request.user == user %}
                  <a href="{% url 'update-user' %}" class="btn btn--main btn--pill">Edit Profile</a>
              {% else %}
                <form id="follow-form" method="POST" action="{% url 'follow-user' user.id %}">
                  {% csrf_token %}
                    {% if is_following %}
                      <button id="follow-button" class="btn btn--main btn--pill">Unfollow</button>
                    {% else %}
                      <button id="follow-button" class="btn btn--main btn--pill">Follow</button>
                    {% endif %}
              {% endif %}
          </div>
            <div class="profile__about">
              <h3>About</h3>
              <p>
                Lorem ipsum dolor sit amet consectetur adipisicing elit. Consequuntur illo tenetur
                facilis sunt nemo debitis quisquam hic atque aut? Ducimus alias placeat optio
                accusamus repudiandae quis ab ex exercitationem rem?
              </p>
            </div>
          </div>

          <div class="roomList__header">
            <div>
              <h2>Rooms Hosted by dennis_ivy</a>
              </h2>
            </div>
          </div>
          
          {% include 'base/feed_component.html' %} 
        </div>
        <!-- Room List End -->

        <!-- Activities Start -->
        {% include 'base/activity_component.html' %}
        <!-- Activities End -->
      </div>
    </main>
{% endblock content %}  

<script>
  $(document).ready(function(){
      $("#follow-form").on('submit', function(event){
          event.preventDefault();
          $.ajax({
              url: $(this).attr('action'),
              type: $(this).attr('method'),
              data: $(this).serialize(),
              dataType: 'json',
              success: function(response) {
                  // Update the follower count on the page
                  $('#follow-count').text(response.num_followers);
                  // Update the follow button text
                  if (response.is_following) {
                      $('#follow-button').text('Unfollow');
                  } else {
                      $('#follow-button').text('Follow');
                  }
              }
          });
      });
  });
  </script>